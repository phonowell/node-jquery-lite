(function(){var t,e,r,i,n,s,o=[].slice,l=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};i=require("lodash"),s=require("request"),module.exports=t={_:i,request:s,version:"0.4.1"},t.extend=i.extend,t.param=require("querystring").stringify,t.trim=i.trim,t.now=i.now,t.each=i.each,t.noop=i.noop,t.type=function(t){var e;return e=Object.prototype.toString.call(t).replace(/^\[object\s(.+)\]$/,"$1").toLowerCase(),"uint8array"===e?"buffer":e},t.serialize=function(e){var r,n,s,o,l,a,u,p,h;switch(t.type(e)){case"object":return e;case"string":if(!~e.search(/=/))return{};for(p={},a=i.trim(e.replace(/\?/g,"")).split("&"),s=0,l=a.length;s<l;s++)r=a[s],n=r.split("="),u=[i.trim(n[0]),i.trim(n[1])],o=u[0],h=u[1],o.length&&(p[o]=h);return p;default:return{}}},e=function(){function e(e){this.option=t.extend({once:!1,memory:!1,unique:!1,stopOnFalse:!1},e),this.status={isDisabled:!1,isLocked:!1,isFired:!1},this.list=[]}return e.prototype.add=function(){var e,r,i,n,s;if(r=1<=arguments.length?o.call(arguments,0):[],this.locked())return this;for(e=function(t){return function(e){if(t.list.push(e),t.option.memory&&t.fired())return e.apply(null,t.args)}}(this),n=0,s=r.length;n<s;n++)i=r[n],"function"===t.type(i)&&(this.option.unique?this.has(i)||e(i):e(i));return this},e.prototype.disable=function(){return this.status.isDisabled=!0,this},e.prototype.disabled=function(){return!!this.status.isDisabled},e.prototype.empty=function(){return this.locked()?this:(this.list=[],this)},e.prototype.fire=function(){var t,e,r,i,n,s;if(t=1<=arguments.length?o.call(arguments,0):[],this.disabled())return this;if(this.option.once&&this.fired())return this;for(n=this.list,r=0,i=n.length;r<i&&(e=n[r],s=e.apply(null,t),!this.option.stopOnFalse||s!==!1);r++);return this.status.isFired=!0,this.option.memory&&(this.args=t),this},e.prototype.fired=function(){return!!this.status.isFired},e.prototype.fireWith=function(){var t,e,r,i,n,s,l;if(e=arguments[0],t=2<=arguments.length?o.call(arguments,1):[],this.disabled())return this;if(this.option.once&&this.fired())return this;for(s=this.list,i=0,n=s.length;i<n&&(r=s[i],l=r.apply(e,t),!this.option.stopOnFalse||l!==!1);i++);return this.status.isFired=!0,this},e.prototype.has=function(t){return l.call(this.list,t)>=0},e.prototype.lock=function(){return this.status.isLocked=!0,this},e.prototype.locked=function(){return!!this.status.isLocked},e.prototype.remove=function(t){return this.locked()?this:(i.remove(this.list,function(e){return e===t}),this)},e}(),t.Callbacks=function(){var t;return t=1<=arguments.length?o.call(arguments,0):[],function(t,e,r){r.prototype=t.prototype;var i=new r,n=t.apply(i,e);return Object(n)===n?n:i}(e,t,function(){})},r=function(){function e(){this.status={isRejected:!1,isResolved:!1,state:"pending"},this.list={resolve:t.Callbacks({once:!0}),reject:t.Callbacks({once:!0}),notify:t.Callbacks()}}var r;return r=function(e,r){if("function"===t.type(e))return r.add(e)},e.prototype.always=function(t){return this.done(t),this.fail(t)},e.prototype.done=function(t){return r(t,this.list.resolve),this},e.prototype.fail=function(t){return r(t,this.list.reject),this},e.prototype.notify=function(){var t,e;return t=1<=arguments.length?o.call(arguments,0):[],this.args=t,(e=this.list.notify).fire.apply(e,t),this},e.prototype.notifyWith=function(){var t,e;return t=1<=arguments.length?o.call(arguments,0):[],this.args=t,(e=this.list.notify).fireWith.apply(e,t),this},e.prototype.progress=function(t){return r(t,this.list.notify),this},e.prototype.promise=function(){return this},e.prototype.reject=function(){var t,e;return t=1<=arguments.length?o.call(arguments,0):[],this.status.state="rejected",this.args=t,(e=this.list.reject).fire.apply(e,t),this},e.prototype.rejectWith=function(){var t,e;return t=1<=arguments.length?o.call(arguments,0):[],this.status.state="rejected",this.args=t,(e=this.list.reject).fireWith.apply(e,t),this},e.prototype.resolve=function(){var t,e;return t=1<=arguments.length?o.call(arguments,0):[],this.status.state="resolved",this.args=t,(e=this.list.resolve).fire.apply(e,t),this},e.prototype.resolveWith=function(){var t,e;return t=1<=arguments.length?o.call(arguments,0):[],this.status.state="resolved",this.args=t,(e=this.list.resolve).fireWith.apply(e,t),this},e.prototype.state=function(){return this.status.state},e.prototype.then=function(){var t;return t=1<=arguments.length?o.call(arguments,0):[],this.done(t[0]),this.fail(t[1])},e}(),t.Deferred=function(){return new r},t.when=function(){var e,r,i,n,s,a,u,p,h;for(i=1<=arguments.length?o.call(arguments,0):[],n=t.Deferred(),h=function(t){return 1===t.length?t[0]:t},p={state:[],def:[]},s=function(t,e){var r,i;return(null!=t&&null!=(r=t.status)?r.state:void 0)?(i=t.status.state,"resolved"===i?(p.state[e]="resolved",void(p.def[e]=h(t.args))):"rejected"===i?(p.state=null,void(p.def=t.args)):(p.state[e]="pending",t.done(function(){var t;return t=1<=arguments.length?o.call(arguments,0):[],n.notify(e,"resolved",t)}).fail(function(){var t;return t=1<=arguments.length?o.call(arguments,0):[],n.reject.apply(n,t)}))):(p.state[e]="resolved",void(p.def[e]=t))},r=a=0,u=i.length;a<u&&(e=i[r],s(e,r),p.state);r=++a);return p.state?l.call(p.state,"pending")>=0?(n.progress(function(t,e,r){if(p.state[t]=e,p.def[t]=h(r),!(l.call(p.state,"pending")>=0))return n.resolve.apply(n,p.def)}),n.promise()):(t.next(function(){return n.resolve.apply(n,p.def)}),n.promise()):(t.next(function(){return n.reject.apply(n,p.def)}),n.promise())},n=function(t){var e;return e=t.headers["content-type"],e&&~e.search(/application\/json/)?"json":"text"},t.get=function(e,r){var s,o,l;return l=t.Deferred(),r&&(o=e.replace(/\?.*/,""),s=t.serialize(e.replace(/.*\?/,"")),i.extend(s,r),e=o+"?"+t.param(s)),t.request({method:"GET",url:e,gzip:!0},function(t,e,r){var i;return t?void l.reject(t):(i=n(e),l.resolve("json"===i?JSON.parse(r):r))}),l.promise()},t.post=function(e,r){var i;return i=t.Deferred(),t.request({method:"POST",url:e,form:r,gzip:!0},function(t,e,r){var s;return t?void i.reject(t):(s=n(e),i.resolve("json"===s?JSON.parse(r):r))}),i.promise()}}).call(this);